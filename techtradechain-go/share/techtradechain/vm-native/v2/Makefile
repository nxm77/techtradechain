VERSION=v2.3.5

build:
	go mod tidy && go build ./...

gomod:
	go get techtradechain.com/techtradechain/pb-go/v2@v2.3.6_qc
	go get techtradechain.com/techtradechain/common/v2@v2.3.8_qc
	go get techtradechain.com/techtradechain/protocol/v2@v2.3.9_qc
	go get techtradechain.com/techtradechain/utils/v2@v2.3.5_qc
	go get techtradechain.com/techtradechain/localconf/v2@v2.3.7_qc
	go get techtradechain.com/techtradechain/chainconf/v2@v2.3.5_qc
	go get techtradechain.com/techtradechain/logger/v2@v2.3.4_qc
	go mod tidy

lint:
	cd accountmgr && golangci-lint run  ./...
	cd blockcontract && golangci-lint run  ./...
	cd certmgr && golangci-lint run  ./...
	cd chainconfigmgr && golangci-lint run  ./...
	cd common && golangci-lint run  ./...
	cd contractmgr && golangci-lint run  ./...
	cd crosstx && golangci-lint run  ./...
	cd dposmgr && golangci-lint run  ./...
	cd government && golangci-lint run  ./...
	cd multisign && golangci-lint run  ./...
	cd privatecompute && golangci-lint run  ./...
	cd pubkeymgr && golangci-lint run  ./...
	cd testcontract && golangci-lint run  ./...
	golangci-lint run  .

ut:
	go test -coverprofile=cover.out ./...
	go tool cover -func=cover.out | tail -1

comment:
	gocloc --include-lang=Go --output-type=json --not-match=_test.go . | jq '(.total.comment-.total.files*5)/(.total.code+.total.comment)*100'
